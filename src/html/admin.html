<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Admin portal</title>

    <link rel="stylesheet" type="text/css" href="../css/admin.css">
    
  </head>
  <body>
    <div id="head" class="text-center">
      <h1 align="center" style="color: azure;">Decentralized Voting Using Ethereum Blockchain</h1>
      <br/> 
    </div>

    <div class="container">
     <legend>Add Candidate</legend>  
     <table  class="table text-center"> 
              <tr>
                <th>Name </th><td>  <input id="name" type="text" name="name" placeholder ="Candidates name" autocomplete="off"></td>  
                <th>Party</th><td><input id="party" type="text" name="party" placeholder ="Candidates party"></td> 
              </tr>
      </table> 
      <input id="addCandidate" type="submit" name="submit" value="Add Candidate">
      <p id="Aday"></p>
    </div>

    <div class="container">
     <legend>Define Voting Dates</legend>  
     <table  class="table text-center"> 
              <tr>              
                <th>Start date</th><td><input id="startDate" type="date" name=""></td>
                <th>End date</th><td>    <input id="endDate" type="date" name="" ></td>
              </tr>
      </table> 
      <input id="addDate" type="submit" name="submit" value="Define Dates">
      <p id="Aday"></p>
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
    <script src="../dist/app.bundle.js" type="module"></script>
    <script>
      // Check if MetaMask is installed
      if (typeof window.ethereum !== 'undefined') {
          console.log('MetaMask is installed!');
      } else {
          console.error('MetaMask is not installed. Please install MetaMask and try again.');
      }

      // Create a Web3 instance
      let web3;
      if (typeof window.ethereum !== 'undefined') {
          web3 = new Web3(window.ethereum);
          console.log('Web3 instance created with MetaMask provider');
          try {
              // Request account access if needed
              ethereum.request({ method: 'eth_requestAccounts' });
          } catch (error) {
              console.error('User denied account access');
          }
      } else if (typeof window.web3 !== 'undefined') {
          // Legacy dapp browsers...
          web3 = new Web3(window.web3.currentProvider);
          console.log('Web3 instance created with legacy provider');
      } else {
          // Non-dapp browsers...
          console.error('Non-Ethereum browser detected. You should consider trying MetaMask!');
      }

      // Check if MetaMask is connected
      async function checkMetaMaskConnection() {
          try {
              // Request accounts
              const accounts = await ethereum.request({ method: 'eth_requestAccounts' });
              
              if (accounts.length > 0) {
                  console.log('MetaMask is connected:', accounts[0]);
              } else {
                  console.error('MetaMask is not connected. Please connect MetaMask and try again.');
              }
          } catch (error) {
              console.error('Error connecting to MetaMask:', error);
          }
      }

      // Call the function to check MetaMask connection
      checkMetaMaskConnection();
    </script>
  </body>
</html>